<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cuenta Corriente – Bertinelli / Lin Racioppi</title>
<style>
  :root{
    --bg:#0f1115;--panel:#171a21;--line:#2a3140;
    --text:#e9ecf1;--muted:#8a90a2;
    --primary:#2563eb;--danger:#7f1d1d;
    --err:#fca5a5;
    --chip:#111827;
  }
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
  .wrap{max-width:1200px;margin:auto;padding:16px}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px;margin:14px 0}
  h1{margin:0 0 6px 0;font-size:20px}
  h2{margin:0 0 8px 0;font-size:15px;color:var(--muted)}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
  .right{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:flex-end}
  .badge{border:1px solid var(--line);padding:6px 12px;border-radius:999px;background:var(--chip)}
  .btn{border:1px solid var(--line);background:#222733;color:var(--text);padding:8px 12px;border-radius:10px;font-weight:650;cursor:pointer}
  .btn.primary{background:var(--primary);border-color:#1d4ed8}
  .btn.danger{background:var(--danger);border-color:#991b1b}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .muted{color:var(--muted);font-size:12px}
  .small{font-size:12px;color:var(--muted)}
  .err{font-size:12px;color:var(--err)}
  table{width:100%;border-collapse:collapse;font-size:13px;margin-top:6px}
  th,td{border-bottom:1px solid var(--line);padding:8px;vertical-align:top}
  th{color:var(--muted);text-align:left;font-weight:650}
  td.num{text-align:right;white-space:nowrap}
  a{color:#93c5fd;text-decoration:none}
  a:hover{text-decoration:underline}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} }
  input,select,textarea{background:#0f1115;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px;width:100%}
  textarea{min-height:70px;resize:vertical}
  hr{border:none;border-top:1px solid var(--line);margin:10px 0}
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);padding:14px}
  .modal.show{display:flex}
  .modal .card{max-width:920px;width:100%}
  .ck{display:flex;gap:8px;align-items:flex-start}
  .ck input{width:auto;margin-top:3px}
</style>
</head>

<body>
<div class="wrap">

  <div class="row">
    <div>
      <h1>Cuenta Corriente – Bertinelli / Lin Racioppi</h1>
      <div id="authBar" class="muted"></div>
    </div>
    <div class="right" id="btnBar">
      <span class="badge" id="saldoBadge">Saldo: —</span>
      <button class="btn primary" id="btnEmitir">Emitir recibo</button>
      <button class="btn primary" id="btnImputar">Imputar pago</button>
      <button class="btn" id="btnPrintPlan">Imprimir Acuerdo + Anexo (A4)</button>
      <button class="btn" id="btnExport">Exportar JSON</button>
      <button class="btn" id="btnImport">Importar JSON</button>
      <button class="btn danger" id="btnReset">Reset TOTAL</button>
    </div>
  </div>

  <div class="card">
    <h2>Cabecera</h2>
    <div><b>Escritura Nº 434</b> – Registro Notarial Nº <b>30</b> – Escribano: <b>Norberto Gustavo Soler</b></div>
    <div>Operación: <b>Compraventa inmueble – 25 de Mayo 8, 6º C, Ciudadela</b></div>
    <div>Vendedor: <b>José Orlando Bertinelli</b> · Comprador: <b>Lautaro Nahuel Lin Racioppi</b></div>
  </div>

  <div class="card">
    <h2>Anexo económico</h2>
    <div>Precio solicitado: USD 44.000</div>
    <div>Precio escriturado: USD 41.000</div>
    <div>Crédito Banco Nación: USD 30.850</div>
    <div>Entrega inicial: USD 5.000 </div>
    <div>Saldo inicial convenido en cuenta corriente: USD 8.150</div>
  </div>

  <div class="card">
    <div class="row" style="align-items:flex-end">
      <h2 style="margin:0">Plan de pagos proyectado</h2>
      <div class="muted" id="planResumen">—</div>
    </div>
    <table>
      <thead>
        <tr>
          <th style="width:110px">Período</th>
          <th>Concepto</th>
          <th class="num" style="width:120px">Monto (U$S)</th>
          <th style="width:200px">Estado</th>
          <th class="num" style="width:150px">Saldo proyectado</th>
        </tr>
      </thead>
      <tbody id="tbodyPlan"></tbody>
    </table>
  </div>

  <div class="card">
    <h2>Recibos emitidos</h2>
    <table>
      <thead>
        <tr>
          <th style="width:110px">Período</th>
          <th>Concepto</th>
          <th class="num" style="width:120px">Monto (U$S)</th>
          <th style="width:220px">Recibo</th>
          <th style="width:140px">Estado</th>
        </tr>
      </thead>
      <tbody id="tbodyRec"></tbody>
    </table>
  </div>

  <div class="card">
    <h2>Libro de movimientos</h2>
    <table>
      <thead>
        <tr>
          <th style="width:110px">Período</th>
          <th>Concepto</th>
          <th class="num" style="width:110px">Débito</th>
          <th class="num" style="width:110px">Crédito</th>
          <th class="num" style="width:110px">Saldo</th>
          <th style="width:190px">Adjunto</th>
        </tr>
      </thead>
      <tbody id="tbodyMov"></tbody>
    </table>
  </div>

</div>

<!-- Modal Emitir -->
<div class="modal" id="modalEmitir">
  <div class="card">
    <h2>Emitir recibo</h2>
    <div class="grid">
      <div>
        <div class="small">Período (MM/AAAA)</div>
        <input id="e_periodo" placeholder="01/2026" />
      </div>
      <div>
        <div class="small">Monto (U$S)</div>
        <input id="e_monto" type="number" min="1" step="1" placeholder="500" />
      </div>
      <div style="grid-column:1/-1">
        <div class="small">Concepto</div>
        <input id="e_concepto" value="Pago mensual" />
      </div>
    </div>
    <div class="row" style="justify-content:flex-end;margin-top:10px">
      <button class="btn" id="e_cancel">Cancelar</button>
      <button class="btn primary" id="e_save">Emitir y ver/imprimir</button>
    </div>
  </div>
</div>

<!-- Modal Imputar -->
<div class="modal" id="modalImputar">
  <div class="card">
    <h2>Imputar pago (obligatorio adjuntar recibo firmado)</h2>
    <div class="muted">
      El archivo adjunto debe ser una imagen o PDF del recibo firmado por ambas partes.
    </div>
    <hr>
    <div class="grid">
      <div>
        <div class="small">Recibo pendiente</div>
        <select id="i_recibo"></select>
      </div>
      <div>
        <div class="small">Adjuntar recibo firmado (foto/scan/PDF)</div>
        <input id="i_file" type="file" accept="image/*,application/pdf" />
        <div class="small" id="i_file_info" style="margin-top:6px"></div>
        <div class="err" id="i_file_err" style="margin-top:4px"></div>
        <div id="i_preview" style="margin-top:10px"></div>
      </div>
      <div style="grid-column:1/-1">
        <div class="small">Observación (opcional)</div>
        <textarea id="i_obs" placeholder="Ej.: se adjunta foto del recibo firmado."></textarea>
      </div>
    </div>

    <div cl
